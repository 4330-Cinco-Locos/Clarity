<!DOCTYPE html>
<html>
    <head>
        <meta charset ="UTF-8"/>
        <meta name="viewport" content = "width=device-width, initial-scale = 1.0" />
        <title>Clarity Chat</title>
        <link rel = "stylesheet" href = "style.css" />
        <script src="script.js"></script>
    </head>
    <body>
        <div class ="active-users">
            <h1>Active Users:</h1>
            <a href="#">John</a>
            <a href="#">Jacob</a>
            <a href="#">Jinkleheimer</a>
        </div>

        <div class = "message-container">
            <div class = "messages">
                <div class = "other-messages message">
                    <div class = "message-sender">Other</div>
                    <div class = "message-body">Hello</div>
                    <div class = "time">10:29 PM</div>
                </div>
                <div class = "my-messages message">
                    <div class = "message-sender">Me</div>
                    <div class = "message-body">Hello</div>
                    <div class = "time">10:29 PM</div>
                </div>
            </div>
            <form class = "user-input-form">
                <input type = "text" class = "my-input" placeholder="My Message..."/>
                <button type = "submit" class = "button send-message-button">Send</button>
                <button class = "button link-image-button">+</button>
            </form>
        </div>
        <script>
            import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";

            const firebaseConfig = {
            apiKey: "AIzaSyAAxXs88pJUfCoeotb0C8gfTGxvltpPBz8",
            authDomain: "clarity-295d8.firebaseapp.com",
            databaseURL: "https://clarity-295d8-default-rtdb.firebaseio.com",
            projectId: "clarity-295d8",
            storageBucket: "clarity-295d8.firebasestorage.app",
            messagingSenderId: "117186684063",
            appId: "1:117186684063:web:a0a70113604e5c07ed2eaa"
            };

            // Initialize Firebase
            const app = initializeApp(firebaseConfig);

            // grabbing the needed database methods
            import {getDatabase, set, get, update, remove, ref, child} from  "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js"

            // initializing variables
            const db = getDatabase();
            var text = document.getElementById(".my-input");  // whatever text the user has entered in the textbox
            var submitBtn = document.getElementById(".send-message-button");
            var userId = "Lane" // TODO: set dynamically
            var imgUrl = "" // TODO: set dynamically

            //CRUD methods
            function sendData()
            {
            time = new Date().toUTCString();
            msgId = userId+time;
            set(ref(db, "chat/"+msgId), {
                senderId: userId,
                body: text.value,
                imageUrl: imgUrl,
                timeStamp: time
            })
            .then(()=>{
                alert("Message sent")
            })
            .catch((error)=>{
                alert(error)
            })
            }

            function getData()
            {

            }

            function updateData()
            {

            }

            function deleteData()
            {

            }

            //event listeners
            submitBtn.addEventListener('click', sendData);
        </script>
    </body>
    <footer>

    </footer>
</html>